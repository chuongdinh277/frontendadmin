// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db" 
}

// 1. Bảng Người dùng (Hỗ trợ cả đăng nhập thường & Google/FB sau này)
model User {
  id            Int       @id @default(autoincrement())
  email         String    @unique
  password      String?   // Dấu ? nghĩa là có thể trống (nếu đăng nhập bằng Google/FB thì ko cần pass)
  name          String?
  avatar        String?   // Ảnh đại diện
  role          String    @default("USER") // "ADMIN" hoặc "USER"
  provider      String    @default("local") // "google", "facebook" hoặc "local"
  createdAt     DateTime  @default(now())
  
  // Quan hệ: 1 người có thể có nhiều đơn thuê
  orders        Order[]
}

// 2. Bảng Sản phẩm (Đồ cho thuê)
model Product {
  id          Int       @id @default(autoincrement())
  name        String
  price       Float     // Giá thuê theo ngày
  description String?
  image       String?
  category    String?   // Váy, Vest, Áo dài...
  status      String    @default("AVAILABLE") // AVAILABLE (Sẵn sàng), RENTED (Đang thuê)
  createdAt   DateTime  @default(now())

  // Quan hệ: 1 sản phẩm có thể nằm trong nhiều đơn thuê (ở các thời điểm khác nhau)
  orders      Order[]
}

// 3. Bảng Đơn thuê (Booking)
model Order {
  id          Int       @id @default(autoincrement())
  startDate   DateTime  // Ngày bắt đầu thuê
  endDate     DateTime  // Ngày trả
  totalPrice  Float     // Tổng tiền
  status      String    @default("PENDING") // PENDING, APPROVED, COMPLETED, CANCELLED
  
  // Liên kết với bảng User (Ai thuê?)
  userId      Int
  user        User      @relation(fields: [userId], references: [id])

  // Liên kết với bảng Product (Thuê cái gì?)
  productId   Int
  product     Product   @relation(fields: [productId], references: [id])

  createdAt   DateTime  @default(now())
}